#!/usr/bin/python
# --*-- coding:utf-8 --*--
import re
import linuxcnc
from Tkinter import *

'''s = linuxcnc.stat() 
s.poll()
filename = s.file
f = open(filename, "r")
lines = f.readlines()'''



class Application(Frame):
    def __init__(self, master=None):
        Frame.__init__(self, master)
        self.grid()
        self.createWidgets()
    def createWidgets(self):
        self.EntryFrame = Frame(self,bd=5)
        self.EntryFrame.grid(row=0, column=1)
        self.Rp = IntVar()
        self.Rp.set(1)
        self.R_Ent = Entry(self.EntryFrame, textvariable=self.Rp ,width=15)
        self.R_Ent.grid(row=10, column=1)
        self.quitButton = Button(self, text='Run',command=self.To)
        self.quitButton.grid(row=13, column=0, sticky=S)
    def To(self):
        filename = './kolco.ngck'
        f = open(filename, "r")
        lines = f.readlines()
        rr = self.R_Ent.get()

        string='o100 repeat[%s]\n' % (rr) 
        w=0
        while not re.search("M2\s*",lines[w], re.I):
            string+=lines[w]
            w+=1
        string +='o100 repeat\n'
        string +='M2\n'
         
        print string
        self.quit()

app = Application()
app.master.title("Grill.py 1.2 by Lawrence Glaister ")
app.mainloop()

















